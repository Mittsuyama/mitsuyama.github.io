
<!doctype html>
<html lang = "en">
    <head>
        <!-- Required meta tags -->
        <meta charset = "utf-8">
        <meta name = "viewport" content = "width = device-width, initial-scale = 1, shrink-to-fit = no">

        <!-- Bootstrap CSS -->
        <!-- <link rel = "stylesheet" href = "https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity = "sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin = "anonymous"> -->
        <link rel = "stylesheet" href = "../css/home.css">
        <link rel = "stylesheet" href = "../css/blog.css">
        <link rel = "stylesheet" href = "../css/index.css">

        <!-- Google Font -->
        <!-- <link href="https://fonts.googleapis.com/css?family=Noto+Sans+SC:300,500" rel="stylesheet"> -->

        <link rel = "icon" href = "../img/icon/favicon.ico" mce_href = "../img/icon/favicon.ico" type = "image/x-icon">
        <link rel = "shortcut icon" href = "../img/icon/favicon.ico" mce_href = "../img/icon/favicon.ico" type = "image/x-icon">

        <link rel = "stylesheet" type = "text/css" href = "../css/search.css">

        <link rel = "stylesheet" href = "../highlight/styles/atom-one-dark.css">

        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.0/css/all.css" integrity="sha384-lZN37f5QGtY3VHgisS14W3ExzMWZxybE1SJSEsQp9S+oqd12jhcu+A56Ebc1zFSJ" crossorigin="anonymous">

        <link rel = "stylesheet" href = "https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/css/share.min.css">
        <script src = "../highlight/highlight.pack.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>

        <!-- <script type="text/javascript" src="http://cdn.webfont.youziku.com/wwwroot/js/wf/youziku.api.min.js"></script>
        <script type="text/javascript">
            $youziku.load("body", "df2ce07dd7614d349931ab631ba1402e", "Source-Han-Light");
            $youziku.load(".normal", "df2ce07dd7614d349931ab631ba1402e", "Source-Han-Light");
            /*．．．*/
            $youziku.draw();
        </script> -->

        <title>计算机系统基础</title>
    </head>

    <body>
        <div class = "nevigation">
                <div class = "nevigation_content1">
                    <a href = "http://mitsuyama.top">
                    <div class = "nav_text_home">
                        MITSUYAMA
                    </div>
                    </a>
                </div>
                <div class = "navigation_content2">
                    <div class = "nav_text" id = "searchButton">
                        <i class = "fa fa-search"></i>
                    </div>
                    <a href = "blog/about.html">
                        <div class = "nav_text">
                            ABOUT
                        </div>
                    </a>
                    <div class = "nav_text">
                        BLOG
                    </div>
                    <a href = "https://github.com/Mittsuyama">
                        <div class = "nav_text">
                            GITHUB
                        </div>
                    </a>
                </div>
            </div>

        <div class = "imgBack"></div>
        <div class = "container-fluid" id = "blogBackground">
            <img src = "../img/blog-image/30.jpg" class = "blogTitleImg">
            <div class = "glass"></div>
            <div class = "blogTitle">
                    计算机系统基础
            </div>
            <div class = "tagContainer">
                &nbspComputer | Note&nbsp&nbsp|&nbsp&nbsp&nbsp肆月 11，2019
            </div>
        </div>

        <div class = "contentListOut">
            <div class = "contentList">
                <div class = "contentBorder">
                    <div class = "contentTitile">┌─ 目录 ───────</div>
                                <a href = "#1" class = "contentListCon" style = "color: rgba(0, 0, 0, 0.5); font-weight: bold;">计算机系统漫游——绪论</a>
            <a href = "#2" class = "contentListCon" style = "color: rgba(0, 0, 0, 0.5); font-weight: bold;">程序结构和执行</a>
            <a href = "#3" class = "contentListCon" style = "padding-left: 40px; color: rgba(0, 0, 0, 0.5);">信息存储</a>
            <a href = "#8" class = "contentListCon" style = "padding-left: 40px; color: rgba(0, 0, 0, 0.5);">程序的机器级表示</a>

                </div>
            </div>
        </div>

        <div class = "blogMainBlock">
            <div class = "articleContext">
                    <div class = "funButtonBox">
                        <div class = "funButtonCir" id = "funUp">
                            <i class = "fa fa-arrow-up" aria-hidden = "true"></i>
                        </div>
                        <div class = "funButtonCir" id = "funCom">
                            <i class = "fa fa-comments" aria-hidden = "true"></i>
                        </div>
                        <div class = "funButtonCir" id = "funList">
                            <i class = "fa fa-list" aria-hidden = "true"></i>
                        </div>
                        <div class = "funButtonCir" id = "funShare">
                            <i class = "fa fa-share-alt" aria-hidden = "true"></i>
                        </div>
                        <div class = "funButtonCir" id = "funSearch">
                            <i class = "fa fa-search" aria-hidden = "true"></i>
                        </div>
                    </div>
                <div class = "articleBorder">
                                    <div class = "h2" id = "1">计算机系统漫游——绪论</div>
                <div class = "normal">作者前言中，对读者应具备的背景知识的描述（节选）：</div>
                <div class = "quote"><i class = "fa fa-quote-left fa-1x fa-pull-left quoteIcon" aria-hidden = "true"></i>中包含大量已在 Linux 系统上编译和运行过的程序示例。我们假设你能访间一台这样的机器,并且能够登录，做一些诸如切换目录之类的简单操作 ……</div>
                <div class = "quoteAgain"></div>
                <div class = "quoteAgain">们还假设你对 C 和 C++ 有一定的了解。如果你以前只有Java经验，那么你需要付出更多的努力来完成这种转换 …… 不过，有一些C语言的特性(特别是指针、显式的动态内存分配和格式化I/o)在Java中都是没有的 ……</div>
                <div class = "normal">这篇博客的内容砍掉了大部分在学习 C 语言就应该掌握的内容（逻辑运算、位运算、各种数据类型表示范围等）</div>
                <div class = "h5">程序编译</div>
                <div class = "normal">GCC 编译器的如何将一个源程序文件 hello.c（输出 "hello world" 的程序） 翻译成一个可执行目标文件 hello。</div>
                <img src = "../img/csf/image-20190415184137204.png" class = "blogImg"><br>
                <div class = "normal">了解 GCC：<a href = "https://zh.wikipedia.org/wiki/GCC" class = "conncetion"><i class="fa fa-paper-plane" aria-hidden="true" ></i>CNU Compile Collection</a></div>
                <div class = "h2" id = "2">程序结构和执行</div>
                <div class = "h3" id = "3">信息存储</div>
                <div class = "h4" id = "4">字数据</div>
                <div class = "h5">位、字节、字</div>
                <div class = "normal" style = "margin: 5px 0px 10px 0px; padding-left: 26px; text-indent: -25px;"><span class = "myList" style = "color: #333">1.</span><span class = "emphasis">比特</span>：或称为「位」，<span class = "underline">最底层</span>的二进制数字（数码）称为位（bit，比特），值位 0 或 1；</div>
                <div class = "normal" style = "margin: -12px 0px 10px 0px; padding-left: 26px; text-indent: -25px;"><span class = "myList" style = "color: #333">2.</span><span class = "emphasis">位组合</span>：把位组合在一起，采用某种规则进行解读</div>
                <div class = "normal" style = "margin: -12px 0px 10px 0px; padding-left: 26px; text-indent: -25px;"><span class = "myList" style = "color: #333">3.</span><span class = "emphasis">字节</span>：8-bit 块（1bytes = 8bits）</div>
                <div class = "normal" style = "margin: -12px 0px 10px 0px; padding-left: 26px; text-indent: -25px;"><span class = "myList" style = "color: #333">4.</span><span class = "emphasis">字</span>：CPU 中 ALU（Arithmetic Logic Unit）的数据位数 = CPU 中<span class = "strong">通用寄存器的位数</span>（通常说计算机是 XX 位的，是指这台计算机 CPU 字的长度 OS 是 XX 位的，是指其 CPU 的工作模式，这与操作系统各 DLL [Dynamic Link Library] 库函数、编译连接环境有关）</div>
                <div class = "h5">字数据大小</div>
                <div class = "quote"><i class = "fa fa-quote-left fa-1x fa-pull-left quoteIcon" aria-hidden = "true"></i> 每台计算机都有一个字长（word size），指明指针数据的标称大小（normal size）。因为虚拟机是以这样的一个字来编码的，所以字长决定的最终的系统参数就是虚拟地址空间的大小。</div>
                <div class = "normal"><span class = "emphasis">字长</span>和<span class = "emphasis">虚拟地址空间</span>我们常常称为<span class = "strong">系统位数</span>（或者说<span class = "strong">机器的字长</span>）和<span class = "strong">内存大小</span>。</div>
                <div class = "normal">32 位系统（32 位字长机器）虚拟地址的范围为 $0 \sim 2^{32} - 1$，只能使用 4G 的内存（虚拟地址空间），而 64 位则能扩展到 16EB。</div>
                <div class = "normal">大多数</div>
                <br>
                <div class = "normal">大多数 64 位机器是可以运行 32 位机器编译的程序，这是一种向后兼容。</div>
                <div class = "normal">若程序 <span class = "emphasis">prog.c</span> 用如下伪指令编译后：</div>
                <pre><code class = "bash">linux&gt; gcc -m32 prog.c                </code></pre>
                <div class = "normal">该程序就可以在 32 位或者 64 位机器上正确运行。</div>
                <div class = "normal">但是如果用如下伪指令编译：</div>
                <pre><code class = "bash">linux&gt; gcc -m64 prog.c                </code></pre>
                <div class = "normal">那就只能在 64 位机器上运行。</div>
                <br>
                <div class = "h5">数据大小</div>
                <div class = "normal">基本 C 数据类型的典型大小（以字节为单位）</div>
                <img src = "../img/csf/image-20190416152929483.png" class = "blogImg"><br>
                <div class = "normal">为了避免由于依赖「典型」大小和不同编译器设置带来的奇怪行为。ISO C99 引入了一类数据类型。其数据大小是固定的，不随编译器和机器设置而变化。其中就有数据类型 <span class = "italic">int32_t</span> 和 <span class = "italic">int64_t</span>，它们分别为 4 字节和 8 字节。</div>
                <div class = "h4" id = "5">寻址和字节顺序</div>
                <div class = "h5">概述</div>
                <div class = "normal">某些机器选择在内存中按照从最低有有效字节到最高有效字节的顺序存储对象，而另一些机器相反。最低有效字节在地址前面的方式，称为小端法；最高有效字节在最前面的方式，称为大端法。</div>
                <div class = "normal">假设变量 x 的类型位 <span class = "italic">int</span>，位于地址 <span class = "italic">0x100</span> 处，它的十六进制值为 <span class = "italic">0x1234567</span>。地址范围 <span class = "italic">0x100 ~ 0x103</span> 的字节顺序依赖机器的类型：</div>
                <img src = "../img/csf/image-20190417110732550.png" class = "blogImg"><br>
                <br>
                <div class = "h5">如何查看机器大小端</div>
                <br>
                <pre><code class = "c">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;

int main() {
    int val = 12345;
    unsigned char *start = &val;
    int len = sizeof(val);
    int i = 0;
    for(i = 0; i &lt; len; i++)
        printf("%.2x ", *(start + i));
    printf("\n");
}                </code></pre>
                <div class = "normal">代码中，把 <span class = "italic">int</span> 强制转换<span class = "emphasis">无符号字符指针</span>，<span class = "italic">start</span> 存放的这个 <span class = "italic">int</span> 变量的初始地址，<span class = "italic">sizeof</span> 获取 <span class = "italic">int</span> 数据长度，<span class = "italic">printf</span> 实现从数据低位向高位循环输出内容。</div>
                <div class = "normal">我实在 MacOS 上进行的试验，结果是：</div>
                <pre><code class = "bash">39 30 00 00                </code></pre>
                <div class = "normal">教材上的结果：</div>
                <img src = "../img/csf/image-20190417190415272.png" class = "blogImg"><br>
                <div class = "normal">参数 <span class = "italic">12345</span> 的十六进制表示为 <span class = "italic">0x00003039</span>。发现 Windows、Linux、MacOS 都是先输出 <span class = "italic">0x39</span>，说明它们都是小端法机器，而 Sun 则是大端法机器。</div>
                <div class = "h4" id = "6">整数表示</div>
                <div class = "h5">补码编码</div>
                <div class = "normal">假如现在有一个钟表：</div>
                <img src = "../img/csf/image-20190417194349834.png" class = "blogImg"><br>
                <div class = "normal">（现在所指时间：八点）</div>
                <div class = "normal">如果我们要将时间拨到 4 点，我们可以将时针逆时针往回拨 4 个刻度到 4 点。</div>
                <div class = "normal">但是，我们也可以将时针顺时针<span class = "strong">顺时针往前拨</span> 8 个刻度，利用时针的循环表示规则（我们称之为自然溢出，12 点 + 1 = 1 点）。</div>
                <br>
                <div class = "normal">补码编码则基于这个原理。</div>
                <div class = "normal">我们假设一个数据类型：<span class = "italic">short short int</span>，只有 4 位（0 表示为 0000）。</div>
                <div class = "normal" style = "margin: 5px 0px 10px 0px; padding-left: 26px; text-indent: -25px;"><span class = "myList" style = "color: #333">1.</span>首先规定：最高位为 1 时时负数，0 为正数。那么最大的正数 0111 十进制下等于 7。</div>
                <div class = "normal" style = "margin: -12px 0px 10px 0px; padding-left: 26px; text-indent: -25px;"><span class = "myList" style = "color: #333">2.</span>我们设定：负数 x 的补码为：取绝对值，然后取反 + 1（0110 取反为 1001），比如 7（1111）表示为 0001。</div>
                <div class = "normal">这就是补码编码，<span class = "emphasis">绝对值取反加一</span>。</div>
                <div class = "normal">下面解释这样做的理由，计算 4 - 2：</div>
                <div class = "normal" style = "margin: 5px 0px 10px 0px; padding-left: 26px; text-indent: -25px;"><span class = "myList" style = "color: #333">1.</span>4 = <span class = "italic">0100</span></div>
                <div class = "normal" style = "margin: -12px 0px 10px 0px; padding-left: 26px; text-indent: -25px;"><span class = "myList" style = "color: #333">2.</span>4 - 2 = 4 + (-2)</div>
                <div class = "normal" style = "margin: -12px 0px 10px 0px; padding-left: 26px; text-indent: -25px;"><span class = "myList" style = "color: #333">3.</span>-2 = <span class = "italic">1110</span></div>
                <div class = "normal" style = "margin: -12px 0px 10px 0px; padding-left: 26px; text-indent: -25px;"><span class = "myList" style = "color: #333">4.</span>4 - 2 = <span class = "italic">0100 + 1110</span> = <span class = "italic">0010</span> = 2（最高位进位自然溢出）</div>
                <div class = "h5">有符号数和无符号数之间的转换</div>
                <pre><code class = "c">short int v = -12345;
unsigned short uv = (unsigned short) v;                </code></pre>
                <div class = "normal">结果：<span class = "italic">v = -12345, uv = 53191</span></div>
                <div class = "normal">强制类型转换的结果保持位值不变（二进制下相同表示），只是改变了解释这些位的方式。</div>
                <br>
                <div class = "normal">C 语言在处理无符号和有符号的运算时，都是隐性地把有符号数转成无符号数来处理。比如小于操作 <span class = "italic">-1 &lt; 0U</span> 的结果（0U 指无符号数 0）为 <span class = "italic">TRUE</span>。</div>
                <div class = "h5">扩展一个数字的位表示</div>
                <div class = "normal">当我们把一个<span class = "strong">短字长数据类型</span>变量强制转换成一个<span class = "strong">长字长数据类型</span>时，如何表示：</div>
                <div class = "normal" style = "margin: 5px 0px 10px 0px; padding-left: 26px; text-indent: -25px;"><span class = "myList" style = "color: #333">1.</span>无符号数的扩展：高位填满 0</div>
                <div class = "normal" style = "margin: -12px 0px 10px 0px; padding-left: 26px; text-indent: -25px;"><span class = "myList" style = "color: #333">2.</span>有符号数的扩展，高位填符号位（即正数填 0，负数填 1）</div>
                <div class = "h5">截断数字</div>
                <div class = "normal">当我们把一个<span class = "strong">长字长数据类型</span>变量强制转换成一个<span class = "strong">短字长数据类型</span>时，如何表示：</div>
                <div class = "normal" style = "margin: 5px 0px 10px 0px; padding-left: 26px; text-indent: -25px;"><span class = "myList" style = "color: #333">1.</span>无符号数截断：直接截断，高位丢掉</div>
                <div class = "normal" style = "margin: -12px 0px 10px 0px; padding-left: 26px; text-indent: -25px;"><span class = "myList" style = "color: #333">2.</span>有符号数截断：同样直接截断，但是按照有符号数解释</div>
                <pre><code class = "c">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;

int main() {
    int x1 = 0b11111111111111110000000000000000;
    int x2 = 0b00000000000000001000000000000000;
    short y = x1;
    short z = x2;
    printf("%d, %d\n", y, z);
    return 0;
}
                </code></pre>
                <div class = "normal">结果：<span class = "italic">0, -32768</span></div>
                <div class = "normal">有符号数截断同样是直接截断，不管符号位。</div>
                <div class = "h4" id = "7">浮点数</div>
                <div class = "h5">原理</div>
                <div class = "normal">表示成有理数的形式：</div>
$$
FLOAT = (-1)^S \; 2^E \; M
$$
                <div class = "normal">其中：</div>
                <div class = "normal" style = "margin: 5px 0px 10px 0px; padding-left: 26px; text-indent: -25px;"><span class = "myList" style = "color: #333">1.</span>S（符号 Sign）：决定正负</div>
                <div class = "normal" style = "margin: -12px 0px 10px 0px; padding-left: 26px; text-indent: -25px;"><span class = "myList" style = "color: #333">2.</span>E（Exponent）：用 $2^E$ 将数值加权</div>
                <div class = "normal" style = "margin: -12px 0px 10px 0px; padding-left: 26px; text-indent: -25px;"><span class = "myList" style = "color: #333">3.</span>M（位数 Significant）：二进制小数</div>
                <div class = "h5">IEEE&nbsp&nbsp浮点编码</div>
                <div class = "normal" style = "margin: 5px 0px 10px 0px; padding-left: 26px; text-indent: -25px;"><span class = "myList" style = "color: #333">1.</span>Sign 字段：符号位 S</div>
                <div class = "normal" style = "margin: -12px 0px 10px 0px; padding-left: 26px; text-indent: -25px;"><span class = "myList" style = "color: #333">2.</span>Exp 字段：编码 E（E 与 exp 不相等，后面会解释）</div>
                <div class = "normal" style = "margin: -12px 0px 10px 0px; padding-left: 26px; text-indent: -25px;"><span class = "myList" style = "color: #333">3.</span>Frac 字段：尾数 M</div>
                <div class = "normal">32 位浮点数：</div>
                <img src = "../img/csf/image-20190331152753273.png" class = "blogImg"><br>
                <div class = "normal">注：图中 Mantissa 等同于 Frac 字段</div>
                <div class = "h5">阶码&nbsp&nbspExp</div>
                <div class = "normal">阶码用<span class = "emphasis">移码</span>表示。举个例子，当 E = -126，Exp 如何表示：</div>
                <div class = "normal" style = "margin: 5px 0px 10px 0px; padding-left: 26px; text-indent: -25px;"><span class = "myList" style = "color: #333">1.</span>E 的真值：-126</div>
                <div class = "normal" style = "margin: -12px 0px 10px 0px; padding-left: 26px; text-indent: -25px;"><span class = "myList" style = "color: #333">2.</span>负数，先改为补码，正数不用此操作：10000010</div>
                <div class = "normal" style = "margin: -12px 0px 10px 0px; padding-left: 26px; text-indent: -25px;"><span class = "myList" style = "color: #333">3.</span>移码 + 127：00000001</div>
                <div class = "normal">这么做，有两个原因：</div>
                <div class = "normal"><span class = "strong">第一个原因</span>：负数和正数能够直接当做无符号数来进行比较，-126 移码后变成 1，-125 变成 2，-1 变成 126，0 变成 127，1 变成 128。</div>
                <div class = "normal"><span class = "italic">-126 &lt; -125 &lt; -1 &lt; 0 &lt; 1</span>：<span class = "italic">1 &lt; 2 &lt; 126 &lt; 127 &lt; 128</span></div>
                <div class = "normal"><span class = "strong">第二个原因</span>：空出 00000000 和 11111111</div>
                <div class = "normal">为什么？为了表示非规格化数。</div>
                <div class = "h5">非规格化数</div>
                <div class = "normal" style = "margin: 5px 0px 10px 0px; padding-left: 26px; text-indent: -25px;"><span class = "myList" style = "color: #333">1.</span>Exp = 000...0，Frac = 000...0：表示 0（<span class = "strong">注意</span>：有 <span class = "italic">+0</span>  和 <span class = "italic">-0</span> 之分）</div>
                <div class = "normal" style = "margin: -12px 0px 10px 0px; padding-left: 26px; text-indent: -25px;"><span class = "myList" style = "color: #333">2.</span>Exp = 000...0，Frac ≠ 000...0：表示最接近 0.0 的那些数，比如 32 位浮点数：$FLOAT = frac * 2^{-126}$</div>
                <div class = "normal" style = "margin: -12px 0px 10px 0px; padding-left: 26px; text-indent: -25px;"><span class = "myList" style = "color: #333">3.</span>Exp = 111…1，Frac = 000...0：表示正负无穷</div>
                <div class = "normal" style = "margin: -12px 0px 10px 0px; padding-left: 26px; text-indent: -25px;"><span class = "myList" style = "color: #333">4.</span>Exp = 111…1，Frac ≠ 000...0：表示这不是个数（比如除以 0 等）， Not a Number (NaN)</div>
                <div class = "h5">规格化数</div>
                <div class = "normal">条件：Exp ≠ 000…0 且 Exp ≠ 111…1</div>
                <div class = "normal">阶码采用偏置值编码：E = Exp - Bias，比如 32 位浮点数，E = Exp - 127</div>
                <div class = "normal">$FLOAT = (-1)^S \times 2^{E - Bias} \times M$</div>
                <div class = "h5">默认的舍入模式</div>
                <div class = "normal" style = "margin: 5px 0px 10px 0px; padding-left: 26px; text-indent: -25px;"><span class = "myList" style = "color: #333">1.</span>恰好在两个可能数值中间时（中间值）：舍入后，最低有效位的数码位偶数</div>
                <div class = "normal" style = "margin: -12px 0px 10px 0px; padding-left: 26px; text-indent: -25px;"><span class = "myList" style = "color: #333">2.</span>其他的时候，像最近的数值舍入（类似于四舍五入，比中间值小向下舍入，比中间值大向上舍入）</div>
                <div class = "normal">举个例子：</div>
                <div class = "normal">7/8：10.11<span class = "strong">110</span> → 11.0<span class = "strong">0</span> → 3</div>
                <div class = "normal">5/8：10.10<span class = "strong">110</span> → 10.1<span class = "strong">0</span> → 2</div>
                <div class = "normal">时间紧缺，后面的内容列一下重点。</div>
                <div class = "h3" id = "8">程序的机器级表示</div>
                <div class = "h4" id = "9">数据格式</div>
                <img src = "../img/csf/image-20190419164001818.png" class = "blogImg"><br>
                <div class = "normal">汇编代码后缀：<span class = "italic">b (bytes) → w (word) → l (double words) → q (quad words)</span></div>
                <div class = "h4" id = "10">访问信息</div>
                <div class = "normal">一个 x86-64 的中央处理单元（CPU）包含一组 16 个存储 64 位值的通用目的寄存器。这些寄存器用来存储整数<span class = "emphasis">数据和指针</span>。</div>
                <div class = "normal" style = "margin: 5px 0px 10px 0px; padding-left: 26px; text-indent: -25px;"><span class = "myList" style = "color: #333">1.</span>名字都以 %r 开头</div>
                <div class = "normal" style = "margin: -12px 0px 10px 0px; padding-left: 26px; text-indent: -25px;"><span class = "myList" style = "color: #333">2.</span>最初的 <span class = "strong">8086</span> 处理器是 8 个 16 位的寄存器，从 %ax 到 %bp</div>
                <div class = "normal" style = "margin: -12px 0px 10px 0px; padding-left: 26px; text-indent: -25px;"><span class = "myList" style = "color: #333">3.</span>后来扩展到 <span class = "strong">IA32</span> 构架，寄存器扩展到 32 位寄存器，标号从 %eax 到 %ebp</div>
                <div class = "normal" style = "margin: -12px 0px 10px 0px; padding-left: 26px; text-indent: -25px;"><span class = "myList" style = "color: #333">4.</span>再扩展到 <span class = "strong">x86-64</span> 构架，寄存器扩展到 64 位，标号从 %rax 到 %rbp，除此之外，还新增了 8 个新的寄存器，标号用新规定命名，从 %r8 到 %r15</div>
                <img src = "../img/csf/image-20190419182315669.png" class = "blogImg"><br>
                <div class = "normal">如图中嵌套的方框标明的，指令可以对这 16 个寄存器的低位字节中存放的不同大小的数据进行操作。字节级操作可以访问最低的字节，16 位操作可以访问最低的 2 个字节 32 位操作可以访问最低的 4 个字节而 64 位操作可以访问整个寄存。</div>
                <div class = "h4" id = "11">操作数指示符</div>
                <div class = "normal">大多数指令有一个或多个<span class = "emphasis">操作数</span>（operand），指示出执行一个操作中要使用的源数据值，以及放置结果的目的位置。</div>
                <img src = "../img/csf/image-20190419191356013.png" class = "blogImg"><br>
                <div class = "normal"><span class = "emphasis">立即数</span>：用来表示常数值。在 ATT 格式的汇编代码中，立即数的书写方式是 「\$」后面跟一个用标准 C 表示法表示的整数，比如：S-577 或 \$0x1F。</div>
                <div class = "normal"><span class = "emphasis">寄存器</span>：表示寄存器的内容。我们用符号 $r_a$ 来表示任意寄存器 $a$ ，用引用 $R[r_a]$ 来表示它的值，这是将<span class = "strong">寄存器集合看成一个数组</span> R，用寄存器标识符作为索引。比如 %rax 获取 rax 寄存器中的内容。</div>
                <div class = "normal"><span class = "emphasis">内存引用</span>：它会根据计算出来的地址（通常称为有效地址）访问某个内存位置。因为将内存看成一个很大的字节数组，我们用符号 $M_b[Addr]$ 表示对存储在内存中从地址 $Addr$ 开始的 $b$ 个字节值的引用。为了简便，我们通常省去下标 $b$。</div>
                <div class = "normal">内存引用举例：</div>
                <div class = "normal" style = "margin: 5px 0px 10px 0px; padding-left: 26px; text-indent: -25px;"><span class = "myList" style = "color: #333">1.</span><span class = "italic">0x80567f</span> 表示获取地址 $\text{0x80567f}$ 中的内容。</div>
                <div class = "normal" style = "margin: -12px 0px 10px 0px; padding-left: 26px; text-indent: -25px;"><span class = "myList" style = "color: #333">2.</span><span class = "italic">0x80567f(%rax)</span> 获取地址 $\text{0x80567f + %rax}$ 中的内容。</div>
                <div class = "normal" style = "margin: -12px 0px 10px 0px; padding-left: 26px; text-indent: -25px;"><span class = "myList" style = "color: #333">3.</span><span class = "italic">0x80567f(%rax, %rbx, 4)</span> 表示获取地址 $\text{0x80567f + %rax + (%rbx * 4)}$ 中的内容。</div>
                <div class = "h4" id = "12">数据传送指令</div>
                <div class = "normal">这时最频繁使用的指令：<span class = "italic">MOV S, D</span>：D ← S</div>
                <div class = "normal">同时后缀 b、w、l、q 传送字节、字、双字、四字</div>
                <div class = "normal">源操作数指定的值是一个<span class = "strong">立即数，存储在寄存器中或者内存中</span>。目的操作数指定一个位置，要么是一个<span class = "strong">寄存器或者，要么是一个内存地址</span>。 x86-64 加了一条限制，传送指令的两个操作数<span class = "emphasis">不能都指向内存位置</span>。</div>
                <div class = "normal">其他传送：MOVZ（零扩展）、MONV（符号扩展）</div>
                <div class = "h5">压入和弹出栈数据</div>
                <div class = "normal">根据惯例，栈是倒过来画的。在 x86-64 中，栈向低地址方向增长，所以压栈是减小栈指针 %rsp 的值。</div>
                <img src = "../img/csf/image-20190420133545024.png" class = "blogImg"><br>
                <div class = "normal"><span class = "italic">pushq %rax</span> 等价于：<span class = "italic">subq $8, %rsp*，*movq %rax, (%rsp)*</div>
                <div class = "normal"><span class = "italic">popq %rdx</span> 等价于：<span class = "italic">movq (%rsp), %rdx</span>，<span class = "italic">addq $8, %rsp*</div>
                <div class = "h4" id = "13">算术和逻辑操作</div>
                <img src = "../img/csf/image-20190420134012012.png" class = "blogImg"><br>
                <div class = "normal">这些指令都有各种带不同大小操作数的变种，比如：ADD 有 addb、addw、addl、addq。<span class = "strong">例外</span>：leaq 没有其他大小的变种</div>
                <br>
                <div class = "normal">加载有效地址 leaq 是 movq 指令的变形，实际操作是将有效地址写入目的操作数。</div>
                <div class = "normal">假设 <span class = "italic">%rdx = x​</span>，那么指令 <span class = "italic">leaq 7(%rdx, %rdx, 4), %rax</span> 的结果是：<span class = "italic">%rax = 5x + 7</span></div>
                <br>
                <div class = "normal">其他移位指令：</div>
                <div class = "normal">ROL 指令（Rotate Left）：向左移位，并将最高位同时拷贝到 CF 和最低位中。同理 ROR</div>
                <div class = "normal">RCL 指令（Rotate Carry Left）：向左移位，将 CF 拷贝到有效最低位，将最高有效位拷贝至 CF 中</div>
                <div class = "h4" id = "14">控制</div>
                <div class = "h5">条件码</div>
                <div class = "normal">除了整数寄存器，CPU 还维护着一组单个位的<span class = "strong">条件码</span>。它们描述最近的运算或逻辑操作的属性。最常用的有：</div>
                <div class = "normal"><span class = "italic">CF、ZF、SF、OF</span></div>
                <div class = "normal">分别是：进位标志、零标志、符号标志（结果是否位负）、溢出标志</div>
                <br>
                <div class = "normal">TEST 和 CMP</div>
                <div class = "normal"><span class = "italic">CMP S D</span>：保存 D - S 的值，不改变 S 和 D</div>
                <div class = "normal"><span class = "italic">TEST %rax, %rax</span> 用来检查 <span class = "italic">%rax</span> 是否是负数、零、还是正数。</div>
                <div class = "h5">访问条件码</div>
                <div class = "normal">条件码通常不能直接读取，常用的有三种方法：</div>
                <div class = "normal" style = "margin: 5px 0px 10px 0px; padding-left: 26px; text-indent: -25px;"><span class = "myList" style = "color: #333">1.</span>根据条件码的某种组合，将一个字节设置为 0 或着 1（SET 指令）</div>
                <div class = "normal" style = "margin: -12px 0px 10px 0px; padding-left: 26px; text-indent: -25px;"><span class = "myList" style = "color: #333">2.</span>可以条件跳转到程序的某个其他部分</div>
                <div class = "normal" style = "margin: -12px 0px 10px 0px; padding-left: 26px; text-indent: -25px;"><span class = "myList" style = "color: #333">3.</span>可以有条件的传送数据</div>
                <div class = "h5">跳转指令</div>
                <div class = "normal">jmp 是<span class = "strong">无条件跳转</span>，可以直接跳转也可间接跳转。</div>
                <div class = "normal"><span class = "emphasis">直接跳转</span>：下图中的 <span class = "italic">.L1</span> 标号，就是利用的直接跳转。</div>
                <img src = "../img/image-20190504123219489.png" class = "blogImg"><br>
                <br>
                <div class = "normal"><span class = "emphasis">间接跳转</span>：</div>
                <div class = "normal">指令 $jmp \; *\%rax$ 用寄存器 %rax 中的值作为跳转目标。而 $jmp \; *(\%rax)$ 以 %rax 中的值作为读地址，从内存中独处跳转目标。</div>
                <br>
                <div class = "normal">其他的跳转指令：</div>
                <img src = "../img/image-20190504125129646.png" class = "blogImg"><br>
                <div class = "h4" id = "15">过程</div>
                <div class = "normal">涉及的几个指令：</div>
                <div class = "normal"><span class = "italic">CALL</span>，<span class = "italic">RET</span>，<span class = "italic">PUSH</span>，<span class = "italic">POP</span>，<span class = "italic">MOV</span></div>
                <img src = "../img/image-20190504130555548.png" class = "blogImg"><br>

                </div>
                <div id = "disqus_thread"></div>
                <!-- <div id = "container"></div>
                <script src="https://imsun.github.io/gitment/dist/gitment.browser.js"></script>
                <script>
                var gitment = new Gitment({
                // id: '页面 ID', // 可选。默认为 location.href
                owner: 'Mitsuyama',
                repo: 'git@github.com:Mittsuyama/mittsuyama.github.io.git',
                oauth: {
                    client_id: '62e2f7957fce993ba7d6',
                    client_secret: 'adc6550219b7d1f1afdf9679e6dce6e599e7bba0',
                },
                })
                gitment.render('container')
                </script> -->
            </div>

            <div id = "foot">
                <div id = "footEmail">
                    Copyright © Mitsuyama | mitsuyama@163.com
                </div>
                <div id = "footTime">
                        UPDATED AT 2019/1/5
                </div>
            </div>

        <div id = "shareBigBox">
            <div class = "social-share" id = "shareBox"></div>
            <i class = "fa fa-times" aria-hidden = "true" id = "shareClose"></i>
        </div>

        <div id = "searchImg">
            <div class = "searchBox">
                <header>
                    <div id = "inputBox">
                        <input id = "my-search-input" placeholder = "SEARCH">
                        <i class = "fa fa-close" aria-hidden = "true" id = "searchIcon"></i>
                        <!-- We use a specific placeholder in the input to guides users in their search. -->
                    </div>
                </header>
                <main>
                    <div id = "hits"></div>
                    <div id = "pagination"></div>
                </main>
            </div>
        </div>

        <script type = "text/html" id = "hit-template">
            <div class = "hit" href = "{{url}}.html">
                <div class = "hit-content">
                    <div class = "hit-title">{{title}}</div>
                    <div class = "hit-tag">{{{_highlightResult.tag.value}}} &nbsp|&nbsp&nbsp {{{_highlightResult.time.value}}}</div>
                    <div class = "hit-brief">{{{_highlightResult.brief.value}}}</div>
                </div>
            </div>
        </script>

        <script>

            /**
            *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
            *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/

                    //加载 disqus
                var disqus_config = function () {
                    this.page.url = 'http://www.mitsuyama.top/blog/30.html';  // Replace PAGE_URL with your page's canonical URL variable
                    this.page.identifier = 'blog30'; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
                    };

        </script>
        <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

        <script src = "https://cdn.jsdelivr.net/npm/instantsearch.js@2.3/dist/instantsearch.min.js"></script>
        <script src = "http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.8.0.js"></script>
        <script src = "../js/blog.js"></script>

        <script src = "https://cdn.jsdelivr.net/npm/instantsearch.js@2.3/dist/instantsearch.min.js"></script>
        <script src = "../js/app.js"></script>

        <script src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML' async></script>
        <script src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.8.0.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/js/social-share.min.js"></script>
        <script type = "text/x-mathjax-config">
            MathJax.Hub.Config({
                tex2jax: {
                    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
                    inlineMath: [['$','$']],
                    processEscapes: true
                }
            });
        </script>
    </body>
</html>